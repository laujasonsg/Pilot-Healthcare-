<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pilot Medical Group | AI Healthcare Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        midnight: '#001F3F',
                        cream: '#F8F8F8',
                        gold: '#C5A059',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Helvetica', 'Arial', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .hidden {
            display: none !important;
            pointer-events: none !important;
        }

        body {
            background-color: #001F3F;
            color: #F8F8F8;
            font-family: 'Playfair Display', serif;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .minimal-input {
            background: transparent;
            border-bottom: 1px solid rgba(248, 248, 248, 0.2);
            padding: 12px 0;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.1em;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.4s ease;
        }
        
        .minimal-input:focus {
            border-bottom-color: #F8F8F8;
        }

        .minimal-button {
            padding: 14px 40px;
            background-color: #F8F8F8;
            color: #001F3F;
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            border: 1px solid #F8F8F8;
            transition: all 0.4s ease;
            cursor: pointer;
            display: inline-block;
            text-align: center;
            z-index: 10;
        }

        .minimal-button:hover:not(:disabled) {
            background-color: transparent;
            color: #F8F8F8;
        }

        .minimal-button:disabled {
            opacity: 0.2;
            cursor: not-allowed;
            background-color: rgba(248, 248, 248, 0.1);
            border-color: rgba(248, 248, 248, 0.1);
            color: rgba(248, 248, 248, 0.3);
        }

        .outline-button {
            padding: 12px 30px;
            background-color: transparent;
            color: #F8F8F8;
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            border: 1px solid rgba(248, 248, 248, 0.4);
            transition: all 0.4s ease;
            cursor: pointer;
            display: inline-block;
            text-align: center;
            text-decoration: none;
            z-index: 10;
        }

        .outline-button:hover {
            border-color: #F8F8F8;
            background-color: rgba(248, 248, 248, 0.05);
        }

        .back-nav-btn {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: rgba(248, 248, 248, 0.4);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            position: absolute;
            top: -10px;
            left: -10px;
            z-index: 50;
        }

        .back-nav-btn:hover {
            color: #F8F8F8;
            transform: translateX(-4px);
        }

        ::-webkit-scrollbar { width: 3px; }
        ::-webkit-scrollbar-track { background: #001F3F; }
        ::-webkit-scrollbar-thumb { background: #334e68; }

        .dashboard-card {
            height: 280px;
            width: 100%;
            max-width: 480px;
            position: relative;
            z-index: 1;
            flex: 1 1 calc(50% - 2rem);
            min-width: 300px;
        }

        .text-vibrant-shadow {
            text-shadow: 0 2px 15px rgba(0,0,0,0.9), 0 1px 5px rgba(0,0,0,1);
        }

        .card-bg {
            filter: grayscale(100%) brightness(0.7);
            opacity: 0.3;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }

        .group:hover .card-bg {
            filter: grayscale(0%) brightness(1.1) saturate(130%);
            opacity: 1;
            transform: scale(1.08);
        }

        .selection-item {
            border: 1px solid rgba(248, 248, 248, 0.1);
            transition: all 0.4s ease;
            cursor: pointer;
            position: relative;
        }

        .selection-item.selected {
            border-color: #F8F8F8;
            background-color: rgba(248, 248, 248, 0.05);
        }

        .selection-label {
            display: flex;
            flex-direction: column;
            justify-content: center;
            width: 100%;
            height: 100%;
            padding: 1.5rem;
            cursor: pointer;
            position: relative;
            z-index: 10;
        }

        .selection-checkbox {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .logout-pill {
            padding: 16px 48px;
            background-color: transparent;
            color: rgba(248, 248, 248, 0.6);
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            border: 1px solid rgba(248, 248, 248, 0.2);
            border-radius: 9999px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            display: block;
            margin: 4rem auto 0;
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .logout-pill:hover {
            border-color: rgba(239, 68, 68, 0.4);
            color: #EF4444;
            background-color: rgba(239, 68, 68, 0.05);
            transform: translateY(-2px);
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background-color: #001F3F;
            border: 1px solid rgba(248, 248, 248, 0.1);
            width: 100%;
            max-width: 650px;
            max-height: 85vh;
            overflow-y: auto;
            padding: 40px;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            color: rgba(248, 248, 248, 0.5);
            transition: color 0.3s ease;
            cursor: pointer;
            z-index: 10;
        }

        .modal-close-btn:hover {
            color: #F8F8F8;
        }

        .legal-text {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            line-height: 1.8;
            opacity: 0.7;
        }

        .legal-text h3 {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            color: #F8F8F8;
            margin-top: 24px;
            margin-bottom: 12px;
            opacity: 1;
        }
    </style>
</head>
<body class="flex flex-col items-center">

    <!-- Persistent Header Logo -->
    <header class="w-full pt-12 pb-8 flex justify-center z-50">
        <h1 class="text-2xl md:text-3xl font-serif tracking-[0.4em] uppercase font-light text-cream opacity-90 text-center">
            PILOT MEDICAL GROUP
        </h1>
    </header>

    <!-- Main Content Wrapper -->
    <main class="w-full flex-grow flex flex-col items-center px-6 pb-20">

        <!-- STEP 1: LOGIN -->
        <section id="step-login" class="fade-in flex flex-col items-center justify-center w-full max-w-md pt-20">
            <div class="w-full space-y-12 text-center">
                <div class="space-y-4">
                    <p class="font-sans text-[10px] tracking-[0.4em] uppercase opacity-50">Private AI Healthcare Portal</p>
                    <h2 class="text-xl font-serif italic">Access Verification</h2>
                </div>
                
                <form id="login-form" class="space-y-8" onsubmit="handleLogin(event)">
                    <div class="relative">
                        <input type="password" id="login-password" placeholder="ACCESS KEY" 
                               class="minimal-input w-full text-center placeholder:opacity-30">
                        <p id="login-error" class="hidden absolute left-0 right-0 -bottom-8 text-[10px] font-sans text-red-400 tracking-widest uppercase py-2">
                            Incorrect Access Key
                        </p>
                    </div>
                    <button type="submit" class="minimal-button mt-4">ENTER</button>
                </form>
            </div>
        </section>

        <!-- STEP 2: DISCLAIMER -->
        <section id="step-disclaimer" class="hidden fade-in flex flex-col items-center justify-center w-full max-w-md pt-10">
            <div class="w-full border border-cream/10 p-10 md:p-14 space-y-10 text-center">
                <header class="space-y-2">
                    <p class="font-sans text-[10px] tracking-widest uppercase opacity-40">Healthcare Notice</p>
                    <h2 class="text-2xl font-serif font-light">Important Disclaimer</h2>
                </header>
                <div class="w-10 h-[1px] bg-cream/20 mx-auto"></div>
                <p class="text-base font-serif leading-relaxed opacity-80 italic">
                    This AI screening tool is for informational and wellness purposes only. It is not a substitute for professional clinical diagnosis or emergency monitoring. If you are experiencing severe symptoms, please contact emergency services or your physician immediately.
                </p>
                <button id="acknowledge-btn" class="minimal-button mt-4" onclick="navigateTo('intake')">I ACKNOWLEDGE</button>
            </div>
        </section>

        <!-- STEP 3: INTAKE FORM -->
        <section id="step-intake" class="hidden fade-in flex flex-col items-center w-full max-w-md pt-10 relative">
            <div class="w-full space-y-12">
                <button id="back-to-login-btn" class="back-nav-btn" onclick="handleBackToLogin()">‚Üê BACK</button>
                <header class="text-center space-y-3 pt-4">
                    <p class="font-sans text-[10px] tracking-widest uppercase opacity-40">Registration</p>
                    <h2 class="text-2xl font-serif font-light">Customer Intake</h2>
                </header>

                <form id="intake-form" class="space-y-10" onsubmit="handleIntakeSubmit(event)">
                    <div class="space-y-8">
                        <div class="flex flex-col">
                            <label for="intake-name" class="text-[10px] font-sans tracking-widest uppercase opacity-40 mb-1 cursor-pointer">Full Legal Name</label>
                            <input type="text" id="intake-name" placeholder="Required" class="minimal-input">
                        </div>
                        <div class="flex flex-col">
                            <label for="intake-email" class="text-[10px] font-sans tracking-widest uppercase opacity-40 mb-1 cursor-pointer">Email Address</label>
                            <input type="email" id="intake-email" placeholder="Email Address (Optional)" class="minimal-input">
                        </div>
                        <div class="flex flex-col">
                            <label for="intake-phone" class="text-[10px] font-sans tracking-widest uppercase opacity-40 mb-1 cursor-pointer">Contact Number</label>
                            <input type="text" id="intake-phone" placeholder="Contact Number (Optional)" class="minimal-input">
                        </div>
                        <div class="flex flex-col">
                            <label for="intake-nric" class="text-[10px] font-sans tracking-widest uppercase opacity-40 mb-1 cursor-pointer">Last 4 Digits NRIC</label>
                            <input type="text" id="intake-nric" maxlength="4" placeholder="NRIC (Optional)" class="minimal-input">
                        </div>
                    </div>

                    <div class="flex flex-col items-center gap-8 py-4">
                        <a href="https://form.jotform.com/260442024345043" target="_blank" class="outline-button">üìù Read & Sign Consent Form</a>
                        
                        <div class="flex items-start gap-4 group w-full">
                            <div class="relative pt-1 flex-shrink-0">
                                <input type="checkbox" id="pdpaConsent" class="peer sr-only cursor-pointer" onchange="validateIntake()">
                                <label for="pdpaConsent" class="block w-4 h-4 border border-cream/30 peer-checked:bg-cream transition-all duration-300 cursor-pointer"></label>
                                <svg class="absolute inset-x-0 inset-y-1.5 w-3.5 h-3.5 text-midnight opacity-0 peer-checked:opacity-100 mx-auto pointer-events-none" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="4">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                                </svg>
                            </div>
                            <label for="pdpaConsent" class="text-[11px] font-sans leading-relaxed opacity-60 group-hover:opacity-100 transition-opacity cursor-pointer">
                                I confirm I have signed the Pilot Medical Group Consent Form and consent to the PDPA policy.
                            </label>
                        </div>
                    </div>

                    <div class="flex justify-center pt-2">
                        <button type="submit" id="intake-next-btn" class="minimal-button" disabled>NEXT PHASE</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- STEP 4: SELECTION PAGE -->
        <section id="step-selection" class="hidden fade-in flex flex-col items-center w-full max-w-2xl pt-10 relative">
            <div class="w-full space-y-12">
                <button id="back-to-intake-btn" class="back-nav-btn" onclick="navigateTo('intake')">‚Üê BACK</button>
                <header class="text-center space-y-3 pt-4">
                    <p class="font-sans text-[10px] tracking-widest uppercase opacity-40">Consultation Setup</p>
                    <h2 class="text-2xl font-serif font-light">AI Screening Selection</h2>
                    <p class="text-[11px] font-sans italic opacity-40">Choose your required AI-driven analyses</p>
                </header>

                <div id="selection-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-cv" class="selection-checkbox screen-check" data-price="4.50" onchange="updateTotalCost()">
                        <label for="sc-cv" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Cardiovascular AI</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$4.50 SGD</p>
                        </label>
                    </div>
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-men" class="selection-checkbox screen-check" data-price="20.00" onchange="updateTotalCost()">
                        <label for="sc-men" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Men's Health AI</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$20.00 SGD</p>
                        </label>
                    </div>
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-neuro" class="selection-checkbox screen-check" data-price="28.00" onchange="updateTotalCost()">
                        <label for="sc-neuro" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Neurological AI</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$28.00 SGD</p>
                        </label>
                    </div>
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-mental" class="selection-checkbox screen-check" data-price="10.00" onchange="updateTotalCost()">
                        <label for="sc-mental" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Mental Health AI</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$10.00 SGD</p>
                        </label>
                    </div>
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-heme" class="selection-checkbox screen-check" data-price="4.50" onchange="updateTotalCost()">
                        <label for="sc-heme" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Hemoglobin Check</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$4.50 SGD</p>
                        </label>
                    </div>
                    <div class="selection-item rounded-sm overflow-hidden">
                        <input type="checkbox" id="sc-musc" class="selection-checkbox screen-check" data-price="15.00" onchange="updateTotalCost()">
                        <label for="sc-musc" class="selection-label">
                            <h4 class="font-serif text-lg tracking-wide">Musculoskeletal Health</h4>
                            <p class="text-[10px] font-sans uppercase tracking-widest opacity-40">$15.00 SGD</p>
                        </label>
                    </div>
                </div>

                <!-- Promo Code Section -->
                <div class="max-w-[340px] mx-auto pt-4 space-y-4">
                    <div class="flex gap-2">
                        <input type="text" id="promo-input" placeholder="Enter Promo Code" class="minimal-input flex-grow text-[11px] placeholder:opacity-40">
                        <button onclick="applyPromoCode()" class="outline-button !px-6 !py-2">Apply</button>
                    </div>
                    <p id="promo-msg" class="text-[9px] font-sans tracking-widest uppercase text-center hidden"></p>
                </div>

                <!-- Pricing Breakdown -->
                <div class="text-center pt-4 space-y-6">
                    <div class="space-y-2 border-t border-cream/10 pt-6">
                        <div class="flex justify-between items-center max-w-[240px] mx-auto text-[11px] font-sans uppercase tracking-widest opacity-60">
                            <span>Subtotal:</span>
                            <span id="subtotal-display">$0.00</span>
                        </div>
                        <div id="discount-row" class="hidden flex justify-between items-center max-w-[240px] mx-auto text-[11px] font-sans uppercase tracking-widest text-gold">
                            <span>Discount:</span>
                            <span id="discount-display">-$0.00</span>
                        </div>
                        <div class="flex justify-between items-center max-w-[240px] mx-auto text-[11px] font-sans uppercase tracking-widest opacity-60">
                            <span>GST (9%):</span>
                            <span id="gst-display">$0.00</span>
                        </div>
                        <div class="flex justify-between items-center max-w-[240px] mx-auto pt-2">
                            <span class="text-[10px] font-sans uppercase tracking-[0.3em] opacity-40">Final Total:</span>
                            <span id="final-total-display" class="text-xl font-serif text-cream font-bold">$0.00 SGD</span>
                        </div>
                    </div>
                    <button id="proceed-to-pay-btn" class="minimal-button" onclick="handleProceedToPayment()">Agree & Proceed to Payment</button>
                </div>
            </div>
        </section>

        <!-- STEP 5: PAYMENT PAGE -->
        <section id="step-payment" class="hidden fade-in flex flex-col items-center w-full max-w-md pt-10 relative">
            <div class="w-full space-y-12">
                <button id="back-to-selection-from-pay-btn" class="back-nav-btn" onclick="navigateTo('selection')">‚Üê BACK</button>
                <header class="text-center space-y-3 pt-4">
                    <p class="font-sans text-[10px] tracking-widest uppercase opacity-40">Secure Transaction</p>
                    <h2 class="text-2xl font-serif font-light">Complete Your Payment</h2>
                    <h3 id="payment-amount-due" class="text-xl font-serif text-cream pt-2 italic">Amount Due: $0.00 SGD</h3>
                </header>

                <div class="flex flex-col items-center space-y-8">
                    <div class="bg-white p-4 rounded-lg shadow-md max-w-xs mx-auto">
                        <img src="https://i.postimg.cc/x8qndMpp/PDF-document-0AA0B9BD18AB-1.png" alt="PayNow QR Code" class="w-full h-auto block">
                    </div>

                    <div class="text-center space-y-6">
                        <p class="text-[11px] font-sans leading-relaxed opacity-60">
                            Scan the QR code above or PayNow directly to <br>
                            <span class="text-cream font-medium">Pilot Healthcare Pte Ltd UEN 202558149M</span>. <br>
                            Please ensure the exact amount is transferred.
                        </p>

                        <div class="w-full space-y-2">
                            <label for="paynow-ref" class="text-[10px] font-sans tracking-widest uppercase opacity-40 cursor-pointer block text-left">Enter PayNow Transaction Reference Number</label>
                            <input type="text" id="paynow-ref" placeholder="Reference Number" class="minimal-input w-full" oninput="validatePayment()">
                        </div>
                    </div>

                    <div class="pt-4">
                        <button id="confirm-payment-btn" class="minimal-button" disabled onclick="handleConfirmPayment()">Confirm Payment & Access AI</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- STEP 6: DASHBOARD -->
        <section id="step-dashboard" class="hidden fade-in w-full max-w-6xl pt-10 relative">
            <div class="w-full space-y-16">
                <button id="back-to-payment-btn" class="back-nav-btn" onclick="navigateTo('payment')">‚Üê BACK</button>
                <header class="text-center space-y-6 pt-4">
                    <p class="font-sans text-[10px] tracking-[0.4em] uppercase opacity-40">Private AI Healthcare Hub by Pilot Medical Group</p>
                    <h2 id="welcome-message" class="text-3xl md:text-4xl font-serif font-light tracking-wide">
                        Pilot AI Healthcare Center
                    </h2>
                    <div class="w-16 h-[1px] bg-cream/20 mx-auto"></div>
                </header>

                <!-- Empty State Message -->
                <div id="dashboard-empty-state" class="hidden text-center py-20 space-y-8">
                    <p class="font-serif text-xl italic opacity-60">No screenings selected. Please go back to add a screening.</p>
                    <button class="minimal-button" onclick="navigateTo('selection')">Return to Selection</button>
                </div>

                <!-- Dashboard Grid/Container with flex-wrap and center -->
                <div id="dashboard-grid" class="flex flex-wrap justify-center items-stretch gap-6 md:gap-8 px-4">
                    <!-- Cardiovascular Health -->
                    <a id="dash-cv" href="https://www.pilotmedicalgroup.com/insight-genesis" target="_blank" rel="noopener noreferrer" 
                       class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700 hover:-translate-y-2 hover:shadow-2xl hover:shadow-white/5">
                        <div class="absolute inset-0 bg-cover bg-center transition-all duration-700 opacity-100 group-hover:scale-110" 
                             style="background-image: url('https://i.postimg.cc/FRqfxrSJ/Screenshot-2026-02-14-at-7-08-27-PM.png'); filter: none;"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2 pointer-events-none">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow drop-shadow-md">Vascular Analysis</span>
                            <div class="flex justify-between items-center">
                                <h3 class="font-serif text-2xl text-white text-vibrant-shadow drop-shadow-md group-hover:italic transition-all">Cardiovascular Health</h3>
                                <svg width="20" height="20" viewBox="0 0 15 15" fill="none" class="text-white text-vibrant-shadow opacity-0 group-hover:opacity-100 transition-opacity"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor"></path></svg>
                            </div>
                        </div>
                    </a>

                    <!-- Neurological Health -->
                    <div id="dash-neuro" class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700">
                        <div class="absolute inset-0 bg-cover bg-center card-bg" 
                             style="background-image: url('https://images.unsplash.com/photo-1559757175-5700dde675bc?auto=format&fit=crop&w=1200&q=80')"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow">Neural Pathways</span>
                            <h3 class="font-serif text-2xl text-white text-vibrant-shadow">Neurological Health</h3>
                        </div>
                        <div class="absolute top-4 right-4 bg-midnight/80 px-3 py-1 text-[8px] font-sans tracking-widest uppercase text-white border border-white/20 backdrop-blur-sm z-20">Coming Soon</div>
                    </div>

                    <!-- Mental Health -->
                    <div id="dash-mental" class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700">
                        <div class="absolute inset-0 bg-cover bg-center card-bg" 
                             style="background-image: url('https://images.unsplash.com/photo-1518133910546-b6c2fb7d79e3?auto=format&fit=crop&w=1200&q=80')"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow">Cognitive Balance</span>
                            <h3 class="font-serif text-2xl text-white text-vibrant-shadow">Mental Health</h3>
                        </div>
                        <div class="absolute top-4 right-4 bg-midnight/80 px-3 py-1 text-[8px] font-sans tracking-widest uppercase text-white border border-white/20 backdrop-blur-sm z-20">Coming Soon</div>
                    </div>

                    <!-- Hemoglobin Check -->
                    <a id="dash-heme" href="https://dashboard.genesis1medtech.com/dashboard" target="_blank" rel="noopener noreferrer" 
                       class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700 hover:-translate-y-2 hover:shadow-2xl hover:shadow-white/5">
                        <div class="absolute inset-0 bg-cover bg-center transition-all duration-700 opacity-100 group-hover:scale-110" 
                             style="background-image: url('https://i.postimg.cc/Jh6BYcJw/Screenshot-2026-02-14-at-6-27-59-PM.png'); filter: none;"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2 pointer-events-none">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow drop-shadow-md">Heme Analysis</span>
                            <div class="flex justify-between items-center">
                                <h3 class="font-serif text-2xl text-white text-vibrant-shadow drop-shadow-md group-hover:italic transition-all">Hemoglobin Check</h3>
                                <svg width="20" height="20" viewBox="0 0 15 15" fill="none" class="text-white text-vibrant-shadow opacity-0 group-hover:opacity-100 transition-opacity"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor"></path></svg>
                            </div>
                        </div>
                    </a>

                    <!-- Men's Health -->
                    <a id="dash-men" href="#" onclick="event.preventDefault()" 
                       class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700 hover:-translate-y-2 hover:shadow-2xl hover:shadow-white/5">
                        <div class="absolute inset-0 bg-cover bg-center card-bg" 
                             style="background-image: url('https://images.unsplash.com/photo-1505330622279-bf7d7fc918f4?auto=format&fit=crop&w=1200&q=80')"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2 pointer-events-none">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow">Vitality & Support</span>
                            <div class="flex justify-between items-center">
                                <h3 class="font-serif text-2xl text-white text-vibrant-shadow group-hover:italic transition-all">Men's Health</h3>
                                <svg width="20" height="20" viewBox="0 0 15 15" fill="none" class="text-white text-vibrant-shadow opacity-0 group-hover:opacity-100 transition-opacity"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor"></path></svg>
                            </div>
                        </div>
                    </a>

                    <!-- Musculoskeletal Health -->
                    <a id="dash-musc" href="#" onclick="event.preventDefault()" 
                       class="group relative block dashboard-card overflow-hidden border border-cream/10 bg-midnight transition-all duration-700 hover:-translate-y-2 hover:shadow-2xl hover:shadow-white/5">
                        <div class="absolute inset-0 bg-cover bg-center card-bg" 
                             style="background-image: url('https://images.unsplash.com/photo-1513506003011-3b037721b96d?auto=format&fit=crop&w=1200&q=80')"></div>
                        <div class="absolute inset-0 flex flex-col justify-end p-8 space-y-2 pointer-events-none">
                            <span class="text-[9px] font-sans tracking-widest text-white uppercase text-vibrant-shadow">Structural Motion</span>
                            <div class="flex justify-between items-center">
                                <h3 class="font-serif text-2xl text-white text-vibrant-shadow group-hover:italic transition-all">Musculoskeletal Health</h3>
                                <svg width="20" height="20" viewBox="0 0 15 15" fill="none" class="text-white text-vibrant-shadow opacity-0 group-hover:opacity-100 transition-opacity"><path d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z" fill="currentColor"></path></svg>
                            </div>
                        </div>
                    </a>
                </div>

                <!-- Logout Button Container -->
                <div class="w-full flex justify-center pb-8">
                    <button class="logout-pill" onclick="handleLogout()">
                        I have completed all the tests - Log Out
                    </button>
                </div>

                <footer class="mt-20 pt-16 border-t border-cream/10 text-center space-y-8">
                    <p class="font-serif text-lg italic opacity-70">
                        "To know oneself is the beginning of all longevity."
                    </p>
                    <div class="flex justify-center">
                        <a href="https://wa.me/6580190641" target="_blank" rel="noopener noreferrer" 
                           class="flex items-center gap-4 font-sans text-[11px] tracking-[0.3em] uppercase text-gold hover:text-cream border-b border-gold/40 pb-2 transition-all duration-500 group">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:scale-110 transition-transform"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                            Speak with a Pilot Healthcare Staff
                        </a>
                    </div>
                </footer>
            </div>
        </section>

        <!-- COMPLIANCE FOOTER -->
        <footer class="mt-12 pb-6 text-center text-xs text-gray-500 w-full font-sans tracking-wider leading-loose">
            <p>¬© 2026 Pilot Medical Group. All rights reserved. | 
                <a href="#" class="hover:text-cream transition-colors underline underline-offset-4 decoration-gray-700" onclick="openTermsModal(event)">Terms of Use</a> | 
                <a href="#" class="hover:text-cream transition-colors underline underline-offset-4 decoration-gray-700" onclick="openPrivacyModal(event)">Privacy Policy</a>
            </p>
            <p class="mt-2 text-[10px] opacity-60">
                Data Protection Officer: Dr. Jocelyn Ng | drng@pilotmedicalgroup.com
            </p>
        </footer>

    </main>

    <!-- TERMS OF USE MODAL -->
    <div id="termsModal" class="modal-overlay" onclick="closeTermsModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-close-btn" onclick="closeTermsModal(event)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </div>
            <h2 class="text-2xl font-serif text-cream mb-6">Terms of Use</h2>
            <div class="legal-text space-y-4">
                <p>By using this platform, you acknowledge and agree to the following terms provided by Pilot Healthcare Pte. Ltd.</p>
                
                <h3>1. Informational Purpose</h3>
                <p>The Pilot Medical Group AI Screening Portal is designed solely for general wellness and informational purposes. The AI-driven analyses provided are not diagnostic tools and do not constitute clinical medical advice.</p>
                
                <h3>2. No Doctor-Patient Relationship</h3>
                <p>Usage of this portal does not establish a formal doctor-patient relationship. Results should be reviewed with a qualified clinical professional for any medical decisions.</p>
                
                <h3>3. Corporate Identity</h3>
                <p>Pilot Healthcare Pte. Ltd. is the operator of this digital platform. Users acknowledge that Pilot Healthcare Pte. Ltd. is a separate legal entity from Pilot Medical Pte. Ltd. (the clinical practice).</p>
                
                <h3>4. Limitation of Liability</h3>
                <p>Pilot Medical Group shall not be held liable for any decisions made based on the preliminary AI screening results provided through this automated portal.</p>
            </div>
            <div class="mt-12 flex justify-center">
                <button class="outline-button !py-3 !px-10" onclick="closeTermsModal(event)">CLOSE</button>
            </div>
        </div>
    </div>

    <!-- PRIVACY POLICY MODAL -->
    <div id="privacyModal" class="modal-overlay" onclick="closePrivacyModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-close-btn" onclick="closePrivacyModal(event)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </div>
            <h2 class="text-2xl font-serif text-cream mb-6">Privacy Policy</h2>
            <div class="legal-text space-y-4">
                <p>At Pilot Medical Group, your privacy is paramount. This policy outlines our commitment to data protection.</p>
                
                <h3>1. Regulatory Compliance</h3>
                <p>We operate in strict compliance with the Personal Data Protection Act 2012 (PDPA) of Singapore and relevant Private Hospitals and Medical Clinics Act (PHMCA) guidelines.</p>
                
                <h3>2. Data Collection & Usage</h3>
                <p>Personal data collected through our intake forms is used exclusively for facilitating clinical care, healthcare operations, and ensuring the accurate delivery of screening results.</p>
                
                <h3>3. Security Measures</h3>
                <p>All data is encrypted and stored in secure environments. We implement rigorous administrative and technical safeguards to prevent unauthorized access or disclosure.</p>
                
                <h3>4. Data Protection Officer (DPO)</h3>
                <p>In accordance with PDPA requirements, we have appointed a dedicated Data Protection Officer to oversee our compliance efforts. For any inquiries regarding your personal data, please contact:</p>
                <p class="italic text-cream opacity-100">
                    Dr. Jocelyn Ng<br>
                    Email: drng@pilotmedicalgroup.com
                </p>
            </div>
            <div class="mt-12 flex justify-center">
                <button class="outline-button !py-3 !px-10" onclick="closePrivacyModal(event)">CLOSE</button>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginPassword = document.getElementById('login-password');
        const loginError = document.getElementById('login-error');
        const intakeName = document.getElementById('intake-name');
        const intakeConsent = document.getElementById('pdpaConsent');
        const intakeNextBtn = document.getElementById('intake-next-btn');
        const screenChecks = document.querySelectorAll('.screen-check');
        const subtotalDisplay = document.getElementById('subtotal-display');
        const discountRow = document.getElementById('discount-row');
        const discountDisplay = document.getElementById('discount-display');
        const gstDisplay = document.getElementById('gst-display');
        const finalTotalDisplay = document.getElementById('final-total-display');
        const welcomeMessage = document.getElementById('welcome-message');
        const paymentAmountDue = document.getElementById('payment-amount-due');
        const paynowRef = document.getElementById('paynow-ref');
        const confirmPaymentBtn = document.getElementById('confirm-payment-btn');
        const promoInput = document.getElementById('promo-input');
        const promoMsg = document.getElementById('promo-msg');
        const proceedToPayBtn = document.getElementById('proceed-to-pay-btn');
        
        // Modals
        const termsModal = document.getElementById('termsModal');
        const privacyModal = document.getElementById('privacyModal');

        const steps = {
            login: document.getElementById('step-login'),
            disclaimer: document.getElementById('step-disclaimer'),
            intake: document.getElementById('step-intake'),
            selection: document.getElementById('step-selection'),
            payment: document.getElementById('step-payment'),
            dashboard: document.getElementById('step-dashboard')
        };

        let currentTotal = 0;
        let activePromoCode = null;

        /** 
         * PROMO CODE DICTIONARY
         */
        const PROMO_CODES = {
            'genesis1': {
                type: 'percentage',
                description: '40% off Hemoglobin Check',
                logic: (subtotal, items) => {
                    if (items.includes('sc-heme')) {
                        const hemePrice = 4.50; 
                        return hemePrice * 0.40; 
                    }
                    return 0;
                }
            },
            'test': {
                type: 'override',
                value: 1.00,
                message: 'Test Mode Activated.',
                description: 'Force final total to $1.00'
            },
            'jason': {
                type: 'override',
                value: 0.00,
                message: 'VIP Code Applied!',
                description: 'Force final total to $0.00'
            }
        };

        // Secure Return Trip Logic
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const status = urlParams.get('status');
            
            // Return Routing based on HitPay status parameters
            if (status === 'completed') {
                const savedName = localStorage.getItem('pilot_name');
                const savedSelections = JSON.parse(localStorage.getItem('pilot_selections') || '[]');
                
                if (savedName) intakeName.value = savedName;
                screenChecks.forEach(cb => {
                    if (savedSelections.includes(cb.id)) {
                        cb.checked = true;
                    }
                });

                const name = savedName || 'Valued Client';
                welcomeMessage.innerHTML = `Welcome back, <span class="italic text-cream">${name}</span>`;
                applySmartFiltering();
                navigateTo('dashboard');

                const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                window.history.replaceState({path: cleanUrl}, '', cleanUrl);
                
            } else if (status === 'canceled' || status === 'failed') {
                alert("Payment was not completed. Please try again.");
                
                const restoreSelections = JSON.parse(sessionStorage.getItem('pilot_selections_restore') || '[]');
                const savedName = localStorage.getItem('pilot_name');
                if (savedName) intakeName.value = savedName;
                
                screenChecks.forEach(cb => {
                    if (restoreSelections.includes(cb.id)) {
                        cb.checked = true;
                    } else {
                        cb.checked = false;
                    }
                });
                
                updateTotalCost();
                navigateTo('selection');

                const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                window.history.replaceState({path: cleanUrl}, '', cleanUrl);
                
            } else {
                navigateTo('login');
            }
        });

        // Navigation Engine
        function navigateTo(stepName) {
            Object.values(steps).forEach(s => {
                s.classList.add('hidden');
                s.style.display = 'none';
            });
            const target = steps[stepName];
            if (target) {
                target.classList.remove('hidden');
                if (['dashboard', 'selection', 'payment'].includes(stepName)) {
                    target.style.display = 'block';
                } else {
                    target.style.display = 'flex';
                }
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Modal Controls
        function openTermsModal(e) { e.preventDefault(); termsModal.classList.add('active'); document.body.style.overflow = 'hidden'; }
        function closeTermsModal(e) { if(e) e.preventDefault(); termsModal.classList.remove('active'); document.body.style.overflow = ''; }
        function openPrivacyModal(e) { e.preventDefault(); privacyModal.classList.add('active'); document.body.style.overflow = 'hidden'; }
        function closePrivacyModal(e) { if(e) e.preventDefault(); privacyModal.classList.remove('active'); document.body.style.overflow = ''; }

        // Event Handlers
        function handleLogin(e) {
            e.preventDefault();
            if (loginPassword.value === '12345') {
                navigateTo('disclaimer');
            } else {
                loginError.classList.remove('hidden');
                loginPassword.classList.add('border-red-400');
                setTimeout(() => {
                    loginError.classList.add('hidden');
                    loginPassword.classList.remove('border-red-400');
                }, 3000);
            }
        }

        function handleBackToLogin() {
            navigateTo('login');
            loginPassword.value = '';
        }

        function validateIntake() {
            const isNameFilled = intakeName.value.trim().length > 0;
            const isConsentChecked = intakeConsent.checked;
            intakeNextBtn.disabled = !(isNameFilled && isConsentChecked);
        }

        intakeName.addEventListener('input', validateIntake);

        function handleIntakeSubmit(e) {
            e.preventDefault();
            navigateTo('selection');
        }

        // Promo Code Logic
        function applyPromoCode() {
            const code = promoInput.value.trim().toLowerCase();
            if (PROMO_CODES[code]) {
                activePromoCode = code;
                const promo = PROMO_CODES[code];
                if (promo.type === 'override') {
                    promoMsg.textContent = promo.message;
                } else {
                    promoMsg.textContent = 'Promo applied!';
                }
                promoMsg.className = 'text-[9px] font-sans tracking-widest uppercase text-center text-green-400 block';
            } else {
                activePromoCode = null;
                promoMsg.textContent = 'Invalid code';
                promoMsg.className = 'text-[9px] font-sans tracking-widest uppercase text-center text-red-400 block';
            }
            updateTotalCost();
        }

        // Selection & Pricing Logic
        function updateTotalCost() {
            let baseSubtotal = 0;
            let selectedIds = [];
            screenChecks.forEach(cb => {
                const item = cb.closest('.selection-item');
                if (cb.checked) {
                    baseSubtotal += parseFloat(cb.dataset.price);
                    item.classList.add('selected');
                    selectedIds.push(cb.id);
                } else {
                    item.classList.remove('selected');
                }
            });
            
            let displaySubtotal = baseSubtotal;
            let discountAmount = 0;
            let gstAmount = 0;
            let finalTotal = 0;
            let showDiscountRow = false;

            if (activePromoCode && PROMO_CODES[activePromoCode]) {
                const promo = PROMO_CODES[activePromoCode];
                if (promo.type === 'override') {
                    displaySubtotal = promo.value;
                    discountAmount = 0;
                    gstAmount = 0;
                    finalTotal = promo.value;
                    showDiscountRow = false;
                } else {
                    discountAmount = promo.logic(baseSubtotal, selectedIds);
                    const netSubtotal = Math.max(0, baseSubtotal - discountAmount);
                    gstAmount = netSubtotal * 0.09;
                    finalTotal = netSubtotal + gstAmount;
                    showDiscountRow = discountAmount > 0;
                    displaySubtotal = baseSubtotal;
                }
            } else {
                gstAmount = baseSubtotal * 0.09;
                finalTotal = baseSubtotal + gstAmount;
                showDiscountRow = false;
                displaySubtotal = baseSubtotal;
            }

            subtotalDisplay.textContent = `$${displaySubtotal.toFixed(2)}`;
            gstDisplay.textContent = `$${gstAmount.toFixed(2)}`;
            finalTotalDisplay.textContent = `$${finalTotal.toFixed(2)} SGD`;
            
            if (showDiscountRow) {
                discountRow.classList.remove('hidden');
                discountDisplay.textContent = `-$${discountAmount.toFixed(2)}`;
            } else {
                discountRow.classList.add('hidden');
            }
            
            currentTotal = finalTotal;
        }

        // Payment Flow Logic
        async function handleProceedToPayment() {
            if (Number(currentTotal.toFixed(2)) === 0) {
                applySmartFiltering();
                const name = intakeName.value.trim() || 'Valued Client';
                welcomeMessage.innerHTML = `Welcome back, <span class="italic text-cream">${name}</span>`;
                navigateTo('dashboard');
                return;
            }

            const originalText = proceedToPayBtn.textContent;
            proceedToPayBtn.disabled = true;
            proceedToPayBtn.textContent = "Redirecting to secure checkout...";

            // Save State Before Redirect (sessionStorage)
            const selections = Array.from(screenChecks)
                .filter(cb => cb.checked)
                .map(cb => cb.id);
            sessionStorage.setItem('pilot_selections_restore', JSON.stringify(selections));
            
            localStorage.setItem('pilot_name', intakeName.value);
            localStorage.setItem('pilot_selections', JSON.stringify(selections));

            try {
                const response = await fetch('/api/create-payment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: Number(currentTotal.toFixed(2)) })
                });

                if (!response.ok) throw new Error('Payment gateway communication error');

                const data = await response.json();
                if (data.url) {
                    window.location.href = data.url;
                } else {
                    throw new Error('No redirect URL provided by API');
                }
            } catch (err) {
                console.error('Payment Flow Error:', err);
                paymentAmountDue.textContent = `Amount Due: $${currentTotal.toFixed(2)} SGD`;
                navigateTo('payment');
                proceedToPayBtn.disabled = false;
                proceedToPayBtn.textContent = originalText;
            }
        }

        // Manual Payment Logic (Fallback)
        function validatePayment() {
            const hasRef = paynowRef.value.trim().length > 0;
            confirmPaymentBtn.disabled = !hasRef;
        }

        function handleConfirmPayment() {
            applySmartFiltering();
            const name = intakeName.value.trim() || 'Valued Client';
            welcomeMessage.innerHTML = `Welcome back, <span class="italic text-cream">${name}</span>`;
            navigateTo('dashboard');
        }

        // Logout & Reset Function
        function handleLogout() {
            loginPassword.value = '';
            screenChecks.forEach(cb => {
                cb.checked = false;
                cb.closest('.selection-item').classList.remove('selected');
            });

            activePromoCode = null;
            promoInput.value = '';
            promoMsg.classList.add('hidden');
            discountRow.classList.add('hidden');
            
            updateTotalCost();
            paynowRef.value = '';
            validatePayment();

            intakeName.value = '';
            const emailField = document.getElementById('intake-email');
            const phoneField = document.getElementById('intake-phone');
            const nricField = document.getElementById('intake-nric');
            if (emailField) emailField.value = '';
            if (phoneField) phoneField.value = '';
            if (nricField) nricField.value = '';
            intakeConsent.checked = false;
            validateIntake();

            localStorage.removeItem('pilot_name');
            localStorage.removeItem('pilot_selections');
            sessionStorage.removeItem('pilot_selections_restore');
            
            navigateTo('login');
        }

        // Smart Filtering Logic
        function applySmartFiltering() {
            const mappings = {
                'sc-cv': 'dash-cv',
                'sc-neuro': 'dash-neuro',
                'sc-mental': 'dash-mental',
                'sc-heme': 'dash-heme',
                'sc-men': 'dash-men',
                'sc-musc': 'dash-musc'
            };

            let visibleCount = 0;
            Object.keys(mappings).forEach(checkId => {
                const checkbox = document.getElementById(checkId);
                const dashCard = document.getElementById(mappings[checkId]);
                
                if (checkbox.checked) {
                    dashCard.classList.remove('hidden');
                    visibleCount++;
                } else {
                    dashCard.classList.add('hidden');
                }
            });

            const emptyState = document.getElementById('dashboard-empty-state');
            const grid = document.getElementById('dashboard-grid');

            if (visibleCount === 0) {
                emptyState.classList.remove('hidden');
                grid.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                grid.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>